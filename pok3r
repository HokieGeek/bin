#!/bin/bash

declare -A xdotool_mods
xdotool_mod["s"]="Shift_L"
xdotool_mod["S"]="Shift_R"
xdotool_mod["c"]="Control_L"
xdotool_mod["C"]="Control_R"
xdotool_mod["a"]="Alt_L"
xdotool_mod["A"]="Alt_R"
xdotool_mod["u"]="Super_L"
xdotool_mod["U"]="Super_R"

declare -A keymap
# keymap["monb-d"]="XF86_Calculator"
keymap["monb-d"]="XF86_MonBrightnessDown"
keymap["monb-u"]="XF86_MonBrightnessUp"

declare -a tools=("xdotool" "xkev")
for t in ${tools}; do
    if command -v ${t} &>/dev/null; then
        tool="${t}"
        break
    fi
done

args=()
if [ ${tool} == ${tools[0]} ]; then # xdotool
while [ $# -gt 0 ]; do
    case $1 in
        # L/R Shift, L/R Ctrl, L/R Alt, L/R Super
        -[sScCaAuU]) args+=("$xdotool_mod[$1]+") ;;
        [^-]*)
            key=$("${keymap[$1]+isset}" ] && echo ${keymap[$1]} || echo $1)
            args+=("${key} ")
            ;;
    esac
    shift
done
else #xkev
while [ $# -gt 0 ]; do
    case $1 in
        # L/R Shift, L/R Ctrl, L/R Alt, L/R Super
        -[sScCaAuU]) args+=($1) ;;
        [^-]*)
            key=$("${keymap[$1]+isset}" ] && echo ${keymap[$1]} || echo $1)
            args+="-e ${key}")
            ;;
    esac
    shift
done
fi
echo "exec ${tool} ${args[@]}"
